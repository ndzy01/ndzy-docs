---
title: html页面渲染
order: 2002
---

<TOC></TOC>

## DOCTYPE

DOCTYPE 文档类型声明。浏览器本身分为两种模式，一种是标准模式，一种是怪异模式，浏览器通过 doctype 来区分这两种模式

![Alt text](https://pic3.zhimg.com/80/v2-3fd5f98260a9d361b2b507853b5bb776_720w.webp)

![Alt text](https://pic4.zhimg.com/80/v2-4b83e1a09080f1aa3fd34f801982a877_720w.webp)

> 回流(重排)一定会重绘 重绘不一定会回流

## 重排 Reflow

> 重排的定义：DOM 结构中的各个元素都有自己的盒子模型，这些都需要浏览器根据各种样式来计算并根据计算结果将元素放到它该出现的位置，这个过程称之为 reflow.

- 页面首次渲染
- 浏览器窗口大小改变
- 元素位置或尺寸发生改变
- 添加或删除可见的 DOM 元素
- 改变元素的内容
- 改变元素的样式（除了改变背景色、字体颜色等的边框颜色、阴影等）

## 重绘 Repaint

> 重绘的定义，当各种盒子的位置，大小以及其他属性，例如颜色，字体大小等都确定下来后，浏览器于是便把这些元素都按照各自的特性绘制了一遍，于是页面的内容出现了，这个过程称为 repaint。

- 改变元素的背景色、字体颜色等的边框颜色、阴影等
- 元素的内容发生改变
- 元素的可见性发生改变
- 元素的位置发生改变
- 因为重排和重绘会导致浏览器重新计算和绘制页面，消耗大量的计算和渲染资源，因此应尽可能避免出现频繁的重排和重绘，例如通过使用 CSS3 的 transform 和 opacity 属性来代替传统的定位和透明度设置，避免频繁地改变 DOM 结构等。

![Alt text](https://pic2.zhimg.com/80/v2-651f2aad8fe320f526967d247b41a9fd_720w.webp)

## CSS 加载会阻塞页面显示吗？

- css 加载不会阻塞 DOM 树的解析
- css 加载会阻塞 DOM 树的渲染
- css 加载会阻塞后面 js 语句的执行

为了防止 css 阻塞，引起页面白屏，可以提高页面加载速度

- 使用 cdn
- 对 css 进行压缩
- 合理利用缓存
- 减少 http 请求，将多个 css 文件合并

## 浏览器是怎么渲染的呢？CSS/DOM 这些

1. 解析 HTML 文档：浏览器从服务器获取 HTML 文件，在内存中解析 HTML 文件，构建 DOM 树。
2. 解析 CSS 样式：浏览器解析 HTML 文件中的 CSS 样式表，生成 CSSOM 树。
3. 构建渲染树：浏览器将 DOM 树和 CSSOM 树结合起来，生成渲染树（也称为呈现树），渲染树只包含需要显示的节点和这些节点的样式信息。
4. 布局：根据渲染树中每个节点的大小和位置信息，计算每个节点在屏幕上的位置。
5. 绘制：将渲染树中的节点绘制在屏幕上。
6. 回流与重绘：如果渲染树中某个节点的布局信息发生改变，浏览器需要重新计算布局并绘制，这个过程称为回流和重绘。
